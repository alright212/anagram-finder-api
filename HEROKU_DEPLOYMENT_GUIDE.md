# ðŸš€ Heroku Deployment Guide

This guide will help you deploy your Estonian Anagram Finder API to Heroku.

## Prerequisites

1. **Heroku Account**: Sign up at [heroku.com](https://heroku.com)
2. **Heroku CLI**: Install from [devcenter.heroku.com/articles/heroku-cli](https://devcenter.heroku.com/articles/heroku-cli)
3. **Git**: Ensure your project is in a Git repository

## Quick Deployment Steps

### 1. Login to Heroku

```bash
heroku login
```

### 2. Create a New Heroku App

```bash
heroku create your-anagram-api-name
# Or let Heroku generate a name:
heroku create
```

### 3. Add PHP Buildpack

```bash
heroku buildpacks:set heroku/php
```

### 4. Set Environment Variables

```bash
# Required Laravel settings
heroku config:set APP_NAME="Estonian Anagram Finder"
heroku config:set APP_ENV=production
heroku config:set APP_DEBUG=false
heroku config:set APP_KEY=$(php artisan key:generate --show)
heroku config:set APP_URL=https://your-app-name.herokuapp.com

# Database (using SQLite for simplicity)
heroku config:set DB_CONNECTION=sqlite
heroku config:set DB_DATABASE=/app/database/database.sqlite

# Session and cache
heroku config:set SESSION_DRIVER=database
heroku config:set CACHE_STORE=database
heroku config:set QUEUE_CONNECTION=database

# Logging
heroku config:set LOG_CHANNEL=errorlog
heroku config:set LOG_STACK=single
heroku config:set LOG_LEVEL=info
```

### 5. Deploy to Heroku

```bash
git add .
git commit -m "Prepare for Heroku deployment"
git push heroku main
```

### 6. Run Database Migrations

```bash
heroku run php artisan migrate --force
```

### 7. Seed the Database (Optional)

```bash
heroku run php artisan db:seed --force
```

## Environment Variables Reference

| Variable        | Description         | Example                                 |
| --------------- | ------------------- | --------------------------------------- |
| `APP_NAME`      | Application name    | "Estonian Anagram Finder"               |
| `APP_ENV`       | Environment         | production                              |
| `APP_DEBUG`     | Debug mode          | false                                   |
| `APP_KEY`       | Laravel app key     | Generated by `php artisan key:generate` |
| `APP_URL`       | Your Heroku app URL | https://your-app.herokuapp.com          |
| `DB_CONNECTION` | Database type       | sqlite                                  |
| `LOG_CHANNEL`   | Logging channel     | errorlog                                |

## Useful Heroku Commands

```bash
# View logs
heroku logs --tail

# Run artisan commands
heroku run php artisan migrate
heroku run php artisan route:list
heroku run php artisan config:show

# Scale dynos
heroku ps:scale web=1

# Open your app in browser
heroku open

# Access Heroku bash
heroku run bash
```

## PostgreSQL Database (Alternative to SQLite)

If you prefer PostgreSQL over SQLite:

```bash
# Add PostgreSQL addon
heroku addons:create heroku-postgresql:mini

# The DATABASE_URL will be automatically set
# Update your database config:
heroku config:set DB_CONNECTION=pgsql
```

## SSL Configuration

Heroku automatically provides SSL certificates for your app. Your API will be available at both:

-   http://your-app-name.herokuapp.com
-   https://your-app-name.herokuapp.com (recommended)

## Troubleshooting

### App doesn't start

```bash
heroku logs --tail
```

### Database issues

```bash
heroku run php artisan migrate:status
heroku run php artisan migrate --force
```

### Clear cache

```bash
heroku run php artisan config:clear
heroku run php artisan cache:clear
heroku run php artisan view:clear
```

### File permissions

```bash
heroku run bash
# Then inside the dyno:
ls -la storage/
chmod -R 755 storage/
```

## API Testing

Once deployed, test your API:

```bash
# Replace your-app-name with your actual Heroku app name
curl https://your-app-name.herokuapp.com/api/health
curl https://your-app-name.herokuapp.com/api/anagrams/kass
```

## Custom Domain (Optional)

To use a custom domain:

```bash
heroku domains:add yourdomain.com
heroku domains:add www.yourdomain.com
```

Then configure your DNS provider to point to Heroku.

---

ðŸŽ‰ **Your Estonian Anagram Finder API is now live on Heroku!**
